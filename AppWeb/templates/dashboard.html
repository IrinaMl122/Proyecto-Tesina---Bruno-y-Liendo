{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<section class="card welcome">
  <h2>Hola {{ nombre or 'usuario' }} ğŸ‘‹</h2>
  <p>AquÃ­ podrÃ¡s gestionar tus proyectos y tareas.</p>
</section>

<section class="card stats">
  <h3>ğŸ“Š Resumen</h3>
  <div class="stats-grid">
    <div class="stat-item">
      <div class="stat-number">{{ total_proyectos or 0 }}</div>
      <div class="stat-label">Total Proyectos</div>
    </div>
    <div class="stat-item">
      <div class="stat-number">{{ proyectos_activos or 0 }}</div>
      <div class="stat-label">En Proceso</div>
    </div>
    <div class="stat-item">
      <div class="stat-number">{{ proyectos_completados or 0 }}</div>
      <div class="stat-label">Realizados</div>
    </div>
    <div class="stat-item">
      <div class="stat-number">{{ proyectos_cancelados or 0 }}</div>
      <div class="stat-label">Cancelados</div>
    </div>
  </div>
</section>

<section class="card actions">
  <h3>ğŸš€ Acciones RÃ¡pidas</h3>
  <div class="action-buttons">
    <a href="{{ url_for('ver_proyectos') }}" class="btn-primary">ğŸ“ Ver Mis Proyectos</a>
    <a href="{{ url_for('crear_proyecto') }}" class="btn-secondary">â• Crear Nuevo Proyecto</a>
  </div>
</section>

{% if proyectos_recientes %}
<section class="card">
  <h3>ğŸ“‹ Proyectos Pendientes</h3>
  <div class="recent-projects">
    {% for proyecto in proyectos_recientes[:3] %}
    <div class="recent-project" style="gap: 10px;">
      <a href="{{ url_for('tareas_por_proyecto', proyecto_id=proyecto.id) }}" style="text-decoration:none; color: inherit; flex:1;">
        <h4 style="margin:0;">{{ proyecto.titulo }}</h4>
      </a>
      <span class="status-badge status-{{ proyecto.estado.replace(' ', '_') }}">
        {% if proyecto.estado == 'en proceso' %}ğŸš€ En Proceso
        {% elif proyecto.estado == 'realizado' %}âœ… Realizado
        {% elif proyecto.estado == 'cancelado' %}âŒ Cancelado
        {% endif %}
      </span>
      <form method="POST" action="{{ url_for('cambiar_estado', proyecto_id=proyecto.id) }}" style="display:inline; margin-left:6px;">
        <input type="hidden" name="estado" value="realizado">
        <button type="submit" class="btn-small">Marcar realizado</button>
      </form>
      <form method="POST" action="{{ url_for('cambiar_estado', proyecto_id=proyecto.id) }}" style="display:inline; margin-left:6px;">
        <input type="hidden" name="estado" value="cancelado">
        <button type="submit" class="btn-small btn-secondary">Cancelar</button>
      </form>
    </div>
    {% endfor %}
  </div>
  <p><a href="{{ url_for('ver_proyectos') }}">Ver todos los proyectos â†’</a></p>
</section>
{% endif %}
{% endblock %}