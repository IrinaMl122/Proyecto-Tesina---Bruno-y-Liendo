{% extends 'base.html' %}

{% block title %}Tareas - {{ proyecto.titulo }}{% endblock %}

{% block content %}
<section class="card">
  <div class="header-actions">
    <h2>üìù Tareas de "{{ proyecto.titulo }}"</h2>
    <a href="{{ url_for('ver_proyectos') }}" class="btn-secondary">‚Üê Volver a proyectos</a>
  </div>

  <form method="POST" action="{{ url_for('crear_tarea', proyecto_id=proyecto.id) }}" class="form">
    <div class="form-group">
      <label>T√≠tulo</label>
      <input type="text" name="titulo" required autocomplete="off">
    </div>
    <div class="form-group">
      <label>Descripci√≥n (opcional)</label>
      <textarea name="descripcion"></textarea>
    </div>
    <div class="form-group">
      <label>Fecha l√≠mite (opcional)</label>
      <input type="date" name="fecha_limite">
    </div>
    <div class="form-actions">
      <button type="submit" class="btn-primary">A√±adir tarea</button>
    </div>
  </form>
</section>

<section class="card">
  <h3>Listado</h3>
  {% if tareas %}
  <div class="projects-grid">
    {% for t in tareas %}
    <div class="project-card">
      <div class="project-header">
        <h3>{{ t.titulo }}</h3>
        <span class="status-badge status-{{ t.estado.replace(' ', '_') }}">{{ t.estado.title() }}</span>
      </div>
      {% if t.descripcion %}
      <p class="project-description">{{ t.descripcion }}</p>
      {% endif %}
      <div class="project-details">
        {% if t.fecha_limite %}
        <div class="detail-item">
          <strong>Fecha l√≠mite:</strong>
          <span>{{ t.fecha_limite.strftime('%d/%m/%Y') if t.fecha_limite else '' }}</span>
        </div>
        {% endif %}
      </div>
      <div class="project-actions">
        <a href="{{ url_for('editar_tarea', tarea_id=t.id) }}" class="btn-small">Editar</a>
        <form method="POST" action="{{ url_for('eliminar_tarea', tarea_id=t.id) }}" style="display:inline" onsubmit="return confirm('¬øEliminar esta tarea?');">
          <button type="submit" class="btn-small btn-secondary">Eliminar</button>
        </form>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="empty-state">
    <h3>No hay tareas a√∫n</h3>
    <p>Agreg√° la primera tarea para este proyecto.</p>
  </div>
  {% endif %}
</section>
{% endblock %}



